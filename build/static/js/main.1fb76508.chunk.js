(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{47:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(40),o=n.n(a),s=(n(47),n(15)),i=n(6),l=n(41),u=n.n(l),d=n(26),b=n.n(d),j=n(42),m=n(0),h=function(e){var t=e.socket,n=e.username,r=e.room,a=e.setShowChat,o=e.setRoom,l=Object(c.useState)(""),u=Object(i.a)(l,2),d=u[0],h=u[1],x=Object(c.useState)([]),f=Object(i.a)(x,2),g=f[0],O=f[1],p=function(){var e=Object(j.a)(b.a.mark((function e(){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==d.trim()){e.next=2;break}return e.abrupt("return");case 2:return c={userId:t.id,room:r,author:n,message:d,time:new Date(Date.now()).toLocaleTimeString()},e.next=5,t.emit("send_message",c);case 5:O((function(e){return[].concat(Object(s.a)(e),[c])})),h("");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){t.on("receive_message",(function(e){O((function(t){return[].concat(Object(s.a)(t),[e])}))}))}),[t]),Object(c.useEffect)((function(){var e=document.getElementById("chat-body");e.scrollTop=e.scrollHeight}),[g]);return Object(m.jsxs)("div",{className:"chat-window h-100 w-80 pb-2 border bg-gray-200 border-gray-300 rounded shadow-lg",children:[Object(m.jsxs)("div",{className:"chat-header flex justify-between bg-gray-800",children:[Object(m.jsxs)("p",{className:"text-green-50 p-2 text-xl leading-6 overflow-ellipsis",children:["Room: ",r]}),Object(m.jsx)("button",{className:"text-green-50 p-2 text-xl leading-6 transition-colors duration-300 hover:bg-red-500",onClick:function(){a(!1),o(""),t.emit("leave_room",{username:n,room:r})},children:"Leave"})]}),Object(m.jsx)("div",{id:"chat-body",className:"chat-body h-80 ml-1 px-1 py-2 flex flex-col overflow-y-scroll",children:g.map((function(e){var n=e.userId,c=e.message,r=e.author,a=e.time;return Object(m.jsxs)("div",{className:"message flex flex-col ".concat(n===t.id?"you":"other"),children:[Object(m.jsx)("div",{className:"message-content break-all px-2 py-1",children:c}),Object(m.jsxs)("div",{className:"chat-meta",children:[Object(m.jsx)("span",{className:"text-sm",children:""===r?"\u795e\u7955\u8a2a\u5ba2":r}),Object(m.jsxs)("span",{className:"text-xs font-light text-gray-500",children:[" - ",a]})]})]},Math.random().toString(36).slice(2))}))}),Object(m.jsxs)("div",{className:"chat-footer",children:[Object(m.jsx)("input",{className:"w-64 px-1 ml-1.5 border border-gray-300",type:"text",placeholder:"\u5b89\u5b89...",onChange:function(e){var t=e.target.value;return h(t)},value:d,onKeyDown:function(e){return"Enter"===e.key&&p()}}),Object(m.jsx)("button",{onClick:p,className:"w-12 border border-gray-300 transition-colors duration-300 hover:bg-blue-500",children:"\u25b6"})]})]})},x=u.a.connect("http://chat.ben6515.tw");var f=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),o=Object(i.a)(a,2),l=o[0],u=o[1],d=Object(c.useState)(""),b=Object(i.a)(d,2),j=b[0],f=b[1],g=Object(c.useState)(!1),O=Object(i.a)(g,2),p=O[0],v=O[1],y=Object(c.useState)([]),w=Object(i.a)(y,2),N=w[0],S=w[1],k=function(){return""===l.trim()?f("\u8acb\u9078\u64c7\u4e00\u500b\u623f\u9593\u6216\u8f38\u5165\u623f\u9593\u7684\u540d\u5b57"):n.length>16||l.length>=16?f("\u540d\u5b57\u6216\u623f\u9593\u7684\u9577\u5ea6\u4e0d\u80fd\u8d85\u904e 16 \u500b\u5b57"):(x.emit("join_room",{username:n,room:l}),void v(!0))};return Object(c.useEffect)((function(){f("")}),[n,l]),Object(c.useEffect)((function(){x.on("status",(function(e){S((function(t){return[].concat(Object(s.a)(t),[e])}))}))}),[]),Object(c.useEffect)((function(){var e=document.getElementById("status-body");e.scrollTop=e.scrollHeight}),[N]),Object(m.jsx)("div",{className:"min-h-screen max-w-full grid justify-center items-center",children:Object(m.jsxs)("div",{className:"font-mono grid grid-clos-2 gap-4 justify-center",children:[p?Object(m.jsx)(h,{socket:x,username:n,room:l,setRoom:u,setShowChat:v}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h2",{className:"text-lg text-center",children:"Live Chat"}),Object(m.jsx)("input",{className:"shadow-md border border-gray-300 px-2 rounded w-64 h-10",type:"text",placeholder:"Name...",onChange:function(e){var t=e.target.value;return r(t)},value:n}),Object(m.jsx)("input",{className:"shadow-md border border-gray-300 px-2 rounded w-64 h-10",type:"text",placeholder:"Room ID...",onChange:function(e){var t=e.target.value;return u(t)},value:l,list:"room-list",onKeyDown:function(e){return"Enter"===e.key&&k()}}),Object(m.jsxs)("datalist",{id:"room-list",children:[Object(m.jsx)("option",{value:"sweet home"}),Object(m.jsx)("option",{value:"gossip"}),Object(m.jsx)("option",{value:"away from table"})]}),Object(m.jsx)("button",{className:"shadow-md border border-gray-300 px-2 rounded w-64 h-10 bg-green-400",onClick:k,children:"join a room"}),j&&Object(m.jsx)("div",{className:"text-red-500",children:j})]}),Object(m.jsx)("div",{id:"status-body",className:"h-20 overflow-y-hidden",children:N.map((function(e){return Object(m.jsx)("p",{className:"text-sm text-gray-500",children:e},Math.random().toString(26).slice(2))}))})]})})},g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,82)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))};o.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(f,{})}),document.getElementById("root")),g()}},[[81,1,2]]]);
//# sourceMappingURL=main.1fb76508.chunk.js.map